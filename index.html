<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>
            Webpage for cricket umpires.
        </title>
        <style>
            body {background-color:black;}
            h1 {color:red;}

            .content {
                max-width: 720px;
                margin: auto;
                padding: 20px;
            }

            .calculator {
                background-color: #1a1a1a;
                padding: 20px;
                border-radius: 8px;
                margin-top: 20px;
            }
            .form-group {
                margin-bottom: 15px;
            }
            label {
                display: block;
                margin-bottom: 5px;
                color: #ddd;
            }
            input[type="number"],
            input[type="time"] {
                width: 100%;
                padding: 8px;
                border: 1px solid #333;
                background-color: #2a2a2a;
                color: white;
                border-radius: 4px;
                box-sizing: border-box;
            }
            input[type="checkbox"] {
                margin-right: 8px;
            }
            button {
                background-color: #cc0000;
                color: white;
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                width: 100%;
                margin-top: 10px;
            }
            button:hover {
                background-color: #ff0000;
            }
            #results {
                margin-top: 20px;
                padding: 15px;
                background-color: #2a2a2a;
                border-radius: 4px;
                display: none;
            }
            .result-item {
                margin-bottom: 8px;
                line-height: 1.4;
            }
        </style>
    </head>

    <body>
        <div class="content">
            <h1>
                Appendix E - Ground-Weather-Light Calculations
            </h1>

            <div class="calculator">
                <div class="form-group">
                    <label>Net playing time (minutes)</label>
                    <input type="number" id="netPlayingTime" min="0">
                </div>

                <div class="form-group">
                    <label>First innings progress time (minutes)</label>
                    <input type="number" id="firstInningsProgressTime" min="0">
                </div>

                <div class="form-group">
                    <label>Lost playing time (minutes)</label>
                    <input type="number" id="lostPlayingTime" min="0">
                </div>

                <div class="form-group">
                    <label>Extra time (minutes)</label>
                    <input type="number" id="extraTime" min="0">
                </div>

                <div class="form-group">
                    <label>Made up time (minutes)</label>
                    <input type="number" id="madeUpTime" min="0">
                </div>

                <div class="form-group">
                    <label>Recommence time (HH:MM)</label>
                    <input type="time" id="recommenceTime">
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="timeouts" checked>
                        Enable timeouts
                    </label>
                </div>

                <button onclick="calculateResults()">Calculate</button>

                <div id="results"></div>
            </div>
        </div>

        <script>
            function maxOverPerBowler(oversPerInnings) {
                if (oversPerInnings >= 10) {
                    const baseOvers = Math.floor(oversPerInnings / 5);
                    const extraOvers = oversPerInnings % 5;
                    return Array(5).fill(0).map((_, i) => i < extraOvers ? baseOvers + 1 : baseOvers);
                } else if (oversPerInnings >= 5 && oversPerInnings <= 9) {
                    const maxOversPerBowler = 2;
                    const numBowlers = Math.floor((oversPerInnings + maxOversPerBowler - 1) / maxOversPerBowler);
                    const distribution = Array(numBowlers).fill(1);
                    const remainingOvers = oversPerInnings - numBowlers;
                    for (let i = 0; i < remainingOvers; i++) {
                        distribution[i] += 1;
                    }
                    return distribution;
                }
                throw new Error("Innings must have at least 5 overs.");
            }

            function powerplayOvers(oversPerInnings) {
                if (oversPerInnings >= 5 && oversPerInnings <= 8) {
                    return [2, oversPerInnings - 2];
                } else if (oversPerInnings >= 9 && oversPerInnings <= 11) {
                    return [3, oversPerInnings - 3];
                } else if (oversPerInnings >= 12 && oversPerInnings <= 14) {
                    return [4, oversPerInnings - 4];
                } else if (oversPerInnings >= 15 && oversPerInnings <= 18) {
                    return [5, oversPerInnings - 5];
                } else if (oversPerInnings >= 19 && oversPerInnings <= 20) {
                    return [6, oversPerInnings - 6];
                }
                throw new Error("Innings must have at least 5 overs.");
            }

            function fieldingTimeouts(oversPerInnings) {
                if (oversPerInnings === 20 || oversPerInnings === 19) {
                    return [6, 9];
                } else if (oversPerInnings === 18 || oversPerInnings === 17) {
                    return [5, 8];
                } else if (oversPerInnings === 16) {
                    return [5, 7];
                } else if (oversPerInnings === 15) {
                    return [5, 6];
                }
                throw new Error("Since the innings is less than or equal to 14 overs, timeouts are not applicable.");
            }

            function battingTimeouts(oversPerInnings) {
                if (oversPerInnings === 20 || oversPerInnings === 19) {
                    return [13, 16];
                } else if (oversPerInnings === 18) {
                    return [12, 15];
                } else if (oversPerInnings === 17) {
                    return [12, 14];
                } else if (oversPerInnings === 16) {
                    return [11, 13];
                } else if (oversPerInnings === 15) {
                    return [10, 12];
                }
                throw new Error("Since the innings is less than or equal to 14 overs, timeouts are not applicable.");
            }

            function calculateResults() {
                try {
                    const netPlayingTime = Number(document.getElementById('netPlayingTime').value);
                    const firstInningsProgressTime = Number(document.getElementById('firstInningsProgressTime').value);
                    const lostPlayingTime = Number(document.getElementById('lostPlayingTime').value);
                    const extraTime = Number(document.getElementById('extraTime').value);
                    const madeUpTime = Number(document.getElementById('madeUpTime').value);
                    const timeouts = document.getElementById('timeouts').checked;

                    if (!netPlayingTime || !firstInningsProgressTime || !lostPlayingTime || !extraTime || !madeUpTime) {
                        alert('Please fill in all required fields');
                        return;
                    }

                    const effectivePlayingTimeLost = lostPlayingTime - (extraTime + madeUpTime);
                    const remainingTime = netPlayingTime - effectivePlayingTimeLost;
                    const dividedByOverRate = remainingTime / 4.25;
                    const maxOversPerTeam = Math.ceil(dividedByOverRate / 2);
                    const lengthInnings = Math.ceil(maxOversPerTeam * 4.25);

                    let resultsHTML = `
                        <div class="result-item">Effective playing time lost: ${effectivePlayingTimeLost} minutes</div>
                        <div class="result-item">Remaining playing time: ${remainingTime} minutes</div>
                        <div class="result-item">Maximum overs: ${dividedByOverRate.toFixed(2)}</div>
                        <div class="result-item">Maximum overs per team: ${maxOversPerTeam}</div>
                        <div class="result-item">Maximum overs per bowler: ${maxOverPerBowler(maxOversPerTeam).join(', ')}</div>
                        <div class="result-item">Powerplay overs: ${powerplayOvers(maxOversPerTeam).join(', ')}</div>
                    `;

                    if (timeouts && maxOversPerTeam >= 15) {
                        const [earliestFielding, latestFielding] = fieldingTimeouts(maxOversPerTeam);
                        const [earliestBatting, latestBatting] = battingTimeouts(maxOversPerTeam);
                        resultsHTML += `
                            <div class="result-item">Earliest fielding timeout: Over ${earliestFielding}</div>
                            <div class="result-item">Latest fielding timeout: Over ${latestFielding}</div>
                            <div class="result-item">Earliest batting timeout: Over ${earliestBatting}</div>
                            <div class="result-item">Latest batting timeout: Over ${latestBatting}</div>
                        `;
                    }

                    resultsHTML += `<div class="result-item">Length of innings: ${lengthInnings} minutes</div>`;

                    const resultsDiv = document.getElementById('results');
                    resultsDiv.innerHTML = resultsHTML;
                    resultsDiv.style.display = 'block';
                } catch (error) {
                    alert(error.message);
                }
            }
        </script>
    </body>
</html>
